<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Torneo de Tenis üéæ - Manager Flexible</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="header-container">
        <h1>Gestor de Torneo de Tenis Flexible</h1>
        <button onclick="borrarDatos()" class="danger-btn" id="global-reset-btn">
            Reiniciar Todo (Borrar Datos)
        </button>
    </div>

    <section id="configuracion">
        <h2>1. Configuraci√≥n del Torneo</h2>
        <div id="config-form">
            <label for="max-jugadores-input">N√∫mero Total de Participantes (debe ser par):</label>
            <input type="number" id="max-jugadores-input" min="2" step="2" value="10">
            <button onclick="configurarMaxJugadores()">Establecer</button>
        </div>
        <p>Tama√±o del Torneo Establecido: <span id="max-jugadores-actual">10</span> jugadores.</p>
    </section>

    <section id="registro">
        <h2>2. Inscripci√≥n de Jugadores</h2>
        <div id="registro-form">
            <input type="text" id="nombre-input" placeholder="Nombre del Jugador">
            <button onclick="agregarParticipante()">A√±adir Jugador</button>
        </div>
        <p>Participantes actuales: <span id="contador-participantes">0</span> / <span id="max-participantes-display">10</span></p>
        <ul id="lista-participantes"></ul>
        <button id="btn-iniciar" onclick="iniciarTorneo()" disabled>Iniciar Torneo</button>
    </section>

    <hr>

    <section id="grupos-fixture" style="display: none;">
        <h2>3. Fase de Grupos y Partidos</h2>
        <div id="grupos-container">
        </div>

        <h3>Registro de Resultados de Grupos</h3>
        <div id="partidos-registro-grupos">
        </div>
    </section>

    <hr>

    <section id="ranking-finales" style="display: none;">
        <h2>4. Rankings y Playoff</h2>

        <div id="rankings-container">
        </div>
        
        <div id="playoffs-registro">
            <h3>Registro de Resultados de Playoff</h3>
            
            <form id="score-form">
                <label for="player-name">Nombre del Jugador:</label>
                <input type="text" id="player-name" required placeholder="Ej: Juan P√©rez"><br><br>

                <label for="player-score">Puntuaci√≥n de Playoff:</label>
                <input type="number" id="player-score" required min="0" value="0"><br><br>
                
                <button type="submit">Guardar Resultado de Playoff</button>
                <p id="message-area" style="color: blue; margin-top: 10px;"></p>
            </form>

        </div>

        <div id="playoffs">
        </div>
    </section>

    <!-- ============================================================== -->
    <!-- ESTE BLOQUE HA SIDO CORREGIDO PARA USAR FIREBASE V8 (8.10.0)   -->
    <!-- V8 crea el objeto global 'firebase' que requiere tu c√≥digo.    -->
    <!-- ============================================================== -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
    
    <script>
        // Your web app's Firebase configuration
        const firebaseConfig = {
            // Aseg√∫rate de que tu clave est√© aqu√≠
            apiKey: "AIzaSyAPUcbUnT7Fabp8TQUj-_5M4Ox4Ip_c3GA", 
            authDomain: "precisiontennisscores.firebaseapp.com",
            projectId: "precisiontennisscores",
            storageBucket: "precisiontennisscores.firebasestorage.app",
            messagingSenderId: "847832314171",
            appId: "1:847832314171:web:ce61405a155f67bf4ac71e",
            measurementId: "G-C842BQXWXN"
        };
        
        // Initialize Firebase (V8)
        const app = firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore(); 
        
        console.log("‚úÖ Firebase App and Firestore initialized!");
    
        // ==============================================
        // FUNCI√ìN DE PRUEBA DE ESCRITURA INMEDIATA
        // ==============================================
        db.collection("config_test").add({
            check: true,
            timestamp: firebase.firestore.FieldValue.serverTimestamp(),
            message: "Successful initial write test."
        })
        .then(() => {
            console.log("üî• TEST EXITOSO: Documento de prueba a√±adido a la colecci√≥n 'config_test'. Las reglas est√°n bien.");
        })
        .catch((error) => {
            console.error("‚ùå TEST FALLIDO: No se pudo escribir en Firestore.", error.message);
            alert("¬°Error de Reglas de Seguridad! Por favor, verifica tu consola de Firebase y publica la regla 'allow read, write: if true;'.");
        });
    </script>
        
    <script src="my-app-logic.js"></script>

    
</body>
</html>
